# 0x01 简介

用户帐户控制（User Account Control，简写作UAC)是微软公司在其Windows Vista及更高版本操作系统中采用的一种控制机制。其原理是通知用户是否对应用程序使用硬盘驱动器和系统文件授权，以达到帮助阻止恶意程序（有时也称为“恶意软件”）损坏系统的效果。

# 0x02 漏洞概述

UAC会话中含有尽可能少的点击操作选项，利用该漏洞很容易就可以提升权限到SYSTEM。

# 0x03 影响版本

cpe：/ o：microsoft：windows_10：-

cpe：/ o：microsoft：windows_10：1607

cpe：/ o：microsoft：windows_10：1709

cpe：/ o：microsoft：windows_10：1803

cpe：/ o：microsoft：windows_10：1809

cpe：/ o：microsoft：windows_10：1903

cpe：/ o：microsoft：windows_7：-：sp1

cpe：/ o：microsoft：windows_8.1：-

cpe：/ o：microsoft：windows_rt_8.1：-

cpe：/ o：microsoft：windows_server_2008：-：sp2

cpe：/ o：microsoft：windows_server_2008：r2：sp1：~~~~ itanium〜

cpe：/ o：microsoft：windows_server_2008：r2：sp1：~~~~ x64〜

cpe：/ o：microsoft：windows_server_2012：-

cpe：/ o：microsoft：windows_server_2012：r2

cpe：/ o：microsoft：windows_server_2016：-

cpe：/ o：microsoft：windows_server_2016：1803

cpe：/ o：microsoft：windows_server_2016：1903

cpe：/ o：microsoft：windows_server_2019：-

# 0x04 环境搭建

Windows 7 sp1 

# 0x05 漏洞复现

新建用户M并添加到User组，切换到用户M

![img](assets/1693816981559-624488e9-029a-4b13-a272-4bcb3895c2cc.png)

以管理员身份运行hhupd.exe

下载地址：

```http
https://github.com/mai-lang-chai/System-Vulnerability/raw/master/Windows/CVE-2019-1388/hhupd.exe
```

![img](assets/1693816981512-05066b61-ed83-484c-92a5-da50fb0e773a.jpeg)



显示详细信息

![img](assets/1693816981656-0893320a-cdf2-43df-afc1-121b27af08a0.png)



显示有关次发布者的证书信息

![img](assets/1693816981528-987b1960-fff9-41e1-8d83-71f1992513b7.png)



点击颁发者链接，关闭窗口

![img](assets/1693816981471-d2dfae66-884a-46c7-843e-9f88ecc76819.png)



页面另存为

![img](assets/1693816982127-4ddc6d71-0704-40e1-8b49-7685e76c4002.jpeg)



输入System32路径

C:\Windows\System32\*.*

![img](assets/1693816982267-f325c151-1563-4a75-b13b-398aced92ea9.jpeg)



![img](assets/1693816982265-b8fad823-a60e-493c-bf1a-7379988f5776.jpeg)



右键打开CMD

![img](assets/1693816982740-843f2bb7-7862-45e8-ad9d-2eac1a36805a.jpeg)



Bingo~

![img](assets/1693816982992-1b049fd1-4960-4a6e-a213-8962554d8d31.jpeg)



Windows Server 2016复现结果：

![img](assets/1693816982930-8e267a1d-9a91-470b-b99f-7165b4c87ba9.jpeg)



参考链接：

https://www.youtube.com/watch?v=3BQKpPNlTSo 

https://threatpost.com/windows-uac-flaw-privilege-escalation/150463/ 