
import gmpy2
import libnum
n= 27668660498922472500375628791494457734606266818069701675622210764530734670055237365964515401136252460079836557528155494395414026102243150264467747552165980034822789855156393675633585523947284822956570940300815688428272179955519784047026721940825678372413325366810714188083971061610916723232303624073197177247909662284658083044930730214376549018326216077245460925474122752843529327818195172608058603907107055047373988772755238592672619677204274349409934926464653606936886759583857600591175832359030213993574196933146787115472217171266027680871426781808322743719797933890050511216176646057404637175233292802202378178923
e= 65537
c= 18746194505700558201384277872169794830163138500190175352733908790643996350322919203747136393360746371577741569251126631209757493122905366053702105332759045216734151732055297533840150160461690079688034702542222629348010873130730138850947050963239142274509302267700676363407236433953421106335256696478544846576588349793045380356414959853449132728689763285560503263564382959242418867269024942936994201056347852441783166626330358921915598417022455483787735380713160844507233190294671732326502779637880003264607831211012590797570894491821030009044382318547417922292596783113728409054655525526445493991152255309734338232398
dp= 84706766478932757866513811508397926260907099696053499252864417428715101182822867026156436364610113936081745297799505943107560000280649681320429156841418693968833000874958070946344585926708929977830356488942445224051910936465571136153158752923982942526321612200665183531221960334047957736135486207600440459975

p=gmpy2.gcd(pow(2,e*dp,n)-2,n)
print(p)
for i in range(1, e):
    p = (dp * e - 1) // i + 1
    if n % p == 0:
        q = n // p
        print(p)
        break

phi_n = (p - 1) * (q - 1)
d = gmpy2.invert(e, phi_n)
m = pow(c, d, n)
print(m)
flag = libnum.n2s(int(m))
print(flag)
